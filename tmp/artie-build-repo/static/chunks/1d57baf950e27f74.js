(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23832,e=>{"use strict";var t=e.i(43476);e.i(20344);var n=e.i(71482);e.i(50711);var r=e.i(81958),o=e.i(71645);let l=Object.prototype.toString,a=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed","terminated"," A network error occurred.","Network connection lost"]),i=[500,2e3],u=(0,o.createContext)(void 0),s=(0,o.createContext)(void 0);function c(){return(0,o.useContext)(s)}let d=(0,o.createContext)(null),h="__convexAuthOAuthVerifier",v="__convexAuthJWT",g="__convexAuthRefreshToken",f="__convexAuthServerStateFetchTime";function w({client:e,serverState:n,onChange:r,shouldHandleCode:c,storage:w,storageNamespace:y,replaceURL:m,children:x}){var C,p;let S,A,R,T,P=(0,o.useRef)(n?._state.token??null),[I,$]=(0,o.useState)(null===P.current),[M,j]=(0,o.useState)(P.current),E=e.verbose??!1,L=(0,o.useCallback)(t=>{E&&(console.debug(`${new Date().toISOString()} ${t}`),e.logger?.logVerbose(t))},[E]),{storageSet:O,storageGet:U,storageRemove:F,storageKey:N}=(C=w,p=y,S=function(){let[e,t]=(0,o.useState)({});return()=>({getItem:t=>e[t],setItem:(e,n)=>{t(t=>({...t,[e]:n}))},removeItem:e=>{t(t=>{let{[e]:n,...r}=t;return r})}})}(),A=(0,o.useMemo)(()=>C??S(),[C]),R=p.replace(/[^a-zA-Z0-9]/g,""),T=(0,o.useCallback)(e=>`${e}_${R}`,[p]),{storageSet:(0,o.useCallback)((e,t)=>A.setItem(T(e),t),[A,T]),storageGet:(0,o.useCallback)(e=>A.getItem(T(e)),[A,T]),storageRemove:(0,o.useCallback)(e=>A.removeItem(T(e)),[A,T]),storageKey:T}),[V,q]=(0,o.useState)(!1),D=(0,o.useCallback)(async e=>{let t,n=null!==P.current;if(null===e.tokens)P.current=null,e.shouldStore&&(await F(v),await F(g)),t=null;else{let{token:n}=e.tokens;if(P.current=n,e.shouldStore){let{refreshToken:t}=e.tokens;await O(v,n),await O(g,t)}t=n}n!==(null!==t)&&await r?.(),j(t),$(!1)},[O,F]);(0,o.useEffect)(()=>{let e=async e=>{if(V)return e.preventDefault(),e.returnValue=!0,"Are you sure you want to leave? Your changes may not be saved."};return b("beforeunload",e),()=>{_("beforeunload",e)}}),(0,o.useEffect)(()=>{let e=e=>{(async()=>{if(e.storageArea===w&&e.key===N(v)){let t=e.newValue;L(`synced access token, is null: ${null===t}`),await D({shouldStore:!1,tokens:null===t?null:{token:t}})}})()};return b("storage",e),()=>_("storage",e)},[D]);let W=(0,o.useCallback)(async t=>{let n,r=0;for(;r<i.length;)try{return await e.unauthenticatedCall("auth:signIn","code"in t?{params:{code:t.code},verifier:t.verifier}:t)}catch(t){if(n=t,!function(e){if(!(e&&"[object Error]"===l.call(e)&&"TypeError"===e.name&&"string"==typeof e.message))return!1;let{message:t,stack:n}=e;return"Load failed"===t?void 0===n||"__sentry_captured__"in e:!!t.startsWith("error sending request for url")||a.has(t)}(t))break;let e=i[r]+100*Math.random();r++,L(`verifyCode failed with network error, retry ${r} of ${i.length} in ${e}ms`),await new Promise(t=>setTimeout(t,e))}throw n},[e]),B=(0,o.useCallback)(async e=>{let{tokens:t}=await W(e);return L(`retrieved tokens, is null: ${null===t}`),await D({shouldStore:!0,tokens:t??null}),null!==t},[e,D]),H=(0,o.useCallback)(async(t,n)=>{let r=n instanceof FormData?Array.from(n.entries()).reduce((e,[t,n])=>(e[t]=n,e),{}):n??{},o=await U(h)??void 0;await F(h);let l=await e.authenticatedCall("auth:signIn",{provider:t,params:r,verifier:o});if(void 0!==l.redirect){let e=new URL(l.redirect);return await O(h,l.verifier),"ReactNative"!==navigator.product&&(window.location.href=e.toString()),{signingIn:!1,redirect:e}}if(void 0!==l.tokens){let{tokens:e}=l;return L(`signed in and got tokens, is null: ${null===e}`),await D({shouldStore:!0,tokens:e}),{signingIn:null!==l.tokens}}return{signingIn:!1}},[e,D,U]),K=(0,o.useCallback)(async()=>{try{await e.authenticatedCall("auth:signOut")}catch(e){}L("signed out, erasing tokens"),await D({shouldStore:!0,tokens:null})},[D,e]),z=(0,o.useCallback)(async({forceRefreshToken:e})=>{if(e){let e=P.current;return await k(g,async()=>{let t=P.current;if(t!==e)return L(`returning synced token, is null: ${null===t}`),t;let n=await U(g)??null;return null!==n?(q(!0),await B({refreshToken:n}).finally(()=>{q(!1)}),L(`returning retrieved token, is null: ${null===t}`),P.current):(q(!1),L("returning null, there is no refresh token"),null)})}return P.current},[B,K,U]),G=(0,o.useRef)(!1);(0,o.useEffect)(()=>{if(void 0===w)throw Error("`localStorage` is not available in this environment, set the `storage` prop on `ConvexAuthProvider`!");let e=async()=>{let e=await U(v)??null;L(`retrieved token from storage, is null: ${null===e}`),await D({shouldStore:!1,tokens:null===e?null:{token:e}})};if(void 0!==n){let t=U(f),r=t=>{if(!t||n._timeFetched>+t){let{token:e,refreshToken:t}=n._state;O(f,n._timeFetched.toString()),D({tokens:null===e||null===t?null:{token:e,refreshToken:t},shouldStore:!0})}else e()};t instanceof Promise?t.then(r):r(t);return}let t=void 0!==window?.location?.search?new URLSearchParams(window.location.search).get("code"):null;if((G.current||t)&&!G.current&&(void 0===c||("function"==typeof c?c():c))){G.current=!0;let e=new URL(window.location.href);e.searchParams.delete("code"),(async()=>{await m(e.pathname+e.search+e.hash),await H(void 0,{code:t}),G.current=!1})()}else e()},[e,U]);let J=(0,o.useMemo)(()=>({signIn:H,signOut:K}),[H,K]),Y=null!==M,Z=(0,o.useMemo)(()=>({isLoading:I,isAuthenticated:Y,fetchAccessToken:z}),[z,I,Y]);return(0,t.jsx)(s.Provider,{value:Z,children:(0,t.jsx)(u.Provider,{value:J,children:(0,t.jsx)(d.Provider,{value:M,children:x})})})}async function k(e,t){let n=window?.navigator?.locks;return void 0!==n?await n.request(e,t):await C(e,t)}function y(e){void 0===globalThis.__convexAuthMutexes&&(globalThis.__convexAuthMutexes={});let t=globalThis.__convexAuthMutexes[e];return void 0===t&&(globalThis.__convexAuthMutexes[e]={currentlyRunning:null,waiting:[]}),t=globalThis.__convexAuthMutexes[e]}function m(e,t){globalThis.__convexAuthMutexes[e]=t}async function x(e,t){let n=y(e);null===n.currentlyRunning?m(e,{currentlyRunning:t().finally(()=>{let t=y(e).waiting.shift();y(e).currentlyRunning=null,m(e,{...y(e),currentlyRunning:void 0===t?null:x(e,t)})}),waiting:[]}):m(e,{...n,waiting:[...n.waiting,t]})}async function C(e,t){return new Promise((n,r)=>{x(e,()=>t().then(e=>n(e)).catch(e=>r(e)))})}function b(e,t,n){window.addEventListener?.(e,t,n)}function _(e,t,n){window.removeEventListener?.(e,t,n)}function p(){return(0,o.useContext)(u)}function S(e){let{client:l,storage:a,storageNamespace:i,replaceURL:u,shouldHandleCode:s,children:d}=e,h=(0,o.useMemo)(()=>({authenticatedCall:(e,t)=>l.action(e,t),unauthenticatedCall:(e,t)=>new n.ConvexHttpClient(l.address,{logger:l.logger}).action(e,t),verbose:l.options?.verbose,logger:l.logger}),[l]);return(0,t.jsx)(w,{client:h,storage:a??("u"<typeof window?void 0:window?.localStorage),storageNamespace:i??l.address,replaceURL:u??(e=>{window.history.replaceState({},"",e)}),shouldHandleCode:s,children:(0,t.jsx)(r.ConvexProviderWithAuth,{client:l,useAuth:c,children:d})})}e.s(["ConvexAuthProvider",()=>S,"useAuthActions",()=>p],23832)},41658,e=>{"use strict";var t=e.i(43476),n=e.i(23832);e.i(50711);let r=new(e.i(82045)).ConvexReactClient("https://ceaseless-hornet-54.convex.cloud");function o({children:e}){return(0,t.jsx)(n.ConvexAuthProvider,{client:r,children:e})}e.s(["ConvexClientProvider",()=>o])}]);