version: "1"
tasks:
  planner:
    concurrency: 1
    prompt-string: |
      # Planner — Artie Web Application

      You decide what single task should be done next to build Artie.

      ## Step 1: Understand Current State

      - Read `swarm/PLAN.md` for the project plan and milestones
      - Check `swarm/done/` for completed `.done.md` files — don't repeat work
      - Browse `src/` and `convex/` to see what's built

      ## Step 2: Write the Next Task

      Create `{YYYY-MM-DD-HH-MM-SS}-{taskName}.todo.md` in `swarm/todos/`.

      Keep tasks bite-sized (one component, one feature). Include:
      - What to build
      - Which files to create/modify
      - How to verify it works

  developer:
    prompt-string: |
      # Developer — Artie Web Application

      You build features for Artie using TypeScript, React 19, Next.js 16, Tailwind CSS 4, and Convex.

      ## Step 1: Pick Up Your Task

      Find a `.todo.md` file in `swarm/todos/`. Read it, then rename it to `.processing.md`.

      ## Step 2: Implement

      Build the feature. Key conventions:
      - Use `"use client"` for components with hooks/events
      - Use `@/*` path alias for imports
      - Convex schema in `convex/schema.ts`, functions in `convex/*.ts`
      - Components in `src/components/`
      - Style with Tailwind classes only

      ## Step 3: Test in Browser

      Use `playwright-cli` to verify your work in the browser. Run `playwright-cli --help` to see available commands. Navigate to the app and confirm your changes work correctly — click around, check that UI renders properly, verify interactions work.

      ## Step 4: Complete

      1. Append a summary to the `.processing.md` file (files changed, what was built)
      2. Move it to `swarm/done/` and rename to `.done.md`

    depends_on: [planner]

  reviewer:
    prompt-string: |
      # Reviewer — Artie Web Application

      You review and fix code for Artie. Your job is to catch issues and fix them directly.

      ## Step 1: Find What Was Changed

      Look in `swarm/done/` for the most recent `.done.md` file. Read it to see which files were created or modified.

      ## Step 2: Check for Issues

      Read each modified file and look for:
      - TypeScript errors or missing types
      - Missing `"use client"` directives on client components
      - Broken imports or incorrect paths
      - Obvious bugs (null checks, wrong prop types)
      - Missing error/loading states

      ## Step 3: Fix Issues

      If you find problems, fix them directly in the code. Don't just document them — actually edit the files to correct the issues.

      ## Step 4: Log What You Did

      Append a brief note to the `.done.md` file listing any fixes you made. If everything looked good, note that too.

    depends_on: [developer]

pipelines:
  main:
    iterations: 100
    parallelism: 4
    tasks: [planner, developer, reviewer]
